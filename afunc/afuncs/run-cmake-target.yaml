afunc_name: run-cmake-target
description: 在指定项目目录中执行 CMake 构建或运行目标，并返回结果。
tools: [bash]
capability: |
  此 AFunc 的能力是在一个 CMake 项目中执行特定的目标。它可以用于构建项目（例如 all）或运行已编译的可执行文件。它会返回执行的状态和完整的日志。
inputs:
  - name: 要执行的 CMake 目标
    description: 例如 'all' 或可执行文件名称。
outputs:
  - name: 执行状态和日志
    description: 一个结构化的 Markdown 格式字符串，包含执行的状态（成功/失败）和完整的日志信息。
constraints:
  - **严格遵循指令**：必须严格按照 `instructions` 字段中的每一条指令执行，不得省略任何步骤
  - 需确保项目已包含 CMakeLists.txt 文件。
  - 执行 'all' 目标前，需确保 CMake 构建目录已存在
instructions:
  - 记录日志到文件 prompts.log，内容为：start afunc {afunc_name} at YYYY-MM-DD HH:MM:SS
  - 记录日志到文件 prompts.log，内容为：cmake -S  {project_path} -B _tmp_workspace/{task_name}/build/
  - 创建cmake工程：命令为： cmake -S {project_path} -B _tmp_workspace/{task_name}/build/
  - 运行target：根据 inputs 字段中的 '要执行的 CMake 目标'，执行相应的构建，并运行命令
  - 返回状态：返回状态和错误日志
